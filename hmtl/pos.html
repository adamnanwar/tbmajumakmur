<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasir - POS Toko Bangunan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="flex h-screen overflow-hidden bg-gray-100">

    <!-- SIDEBAR -->
    <aside class="w-64 bg-slate-900 text-slate-300 flex flex-col shadow-xl flex-shrink-0">
        <div class="p-6 border-b border-slate-800 flex items-center gap-3">
            <div class="h-8 w-8 bg-blue-600 text-white rounded flex items-center justify-center font-bold">TB</div>
            <span class="font-bold text-lg text-white">Makmur Lestari</span>
        </div>
        <nav class="flex-1 p-4 space-y-1 overflow-y-auto">
            <p class="px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 mt-2">Menu Utama</p>
            <a href="dashboard.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-800 hover:text-white transition-colors">
                <i class="ph ph-squares-four text-lg"></i> Dashboard
            </a>
            <!-- Active State -->
            <a href="pos.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md bg-blue-600 text-white shadow-md">
                <i class="ph ph-shopping-cart text-lg"></i> Kasir (POS)
            </a>
            <a href="inventory.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-800 hover:text-white transition-colors">
                <i class="ph ph-package text-lg"></i> Inventaris
            </a>
            <p class="px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 mt-6">Laporan</p>
            <a href="reports.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-800 hover:text-white transition-colors">
                <i class="ph ph-receipt text-lg"></i> Laporan Transaksi
            </a>
            <p class="px-3 text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 mt-6">Admin</p>
            <a href="users.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-800 hover:text-white transition-colors">
                <i class="ph ph-users text-lg"></i> Pengguna
            </a>
            <a href="settings.html"
                class="flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-800 hover:text-white transition-colors">
                <i class="ph ph-gear text-lg"></i> Pengaturan
            </a>
        </nav>
        <div class="p-4 border-t border-slate-800">
            <a href="login.html" onclick="return confirm('Keluar dari sistem?')"
                class="flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-slate-800 hover:text-red-300 rounded-md transition-colors w-full cursor-pointer">
                <i class="ph ph-sign-out text-lg"></i> Keluar
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col overflow-hidden">
        <header class="h-16 bg-white shadow-sm flex items-center justify-between px-6 z-10 border-b flex-shrink-0">
            <h2 class="font-bold text-xl text-slate-800">Point of Sales</h2>
            <div class="bg-slate-100 text-slate-600 px-4 py-1.5 rounded-full text-sm font-medium" id="date-display">
            </div>
        </header>

        <div class="flex-1 overflow-hidden p-4 flex flex-col md:flex-row gap-4">
            <!-- Product Grid -->
            <div class="flex-1 flex flex-col bg-white rounded-lg border border-slate-200 shadow-sm overflow-hidden">
                <div class="p-4 border-b border-slate-100 bg-white">
                    <div class="relative">
                        <i class="ph ph-magnifying-glass absolute left-3 top-2.5 text-slate-400 text-lg"></i>
                        <input type="text" id="search-input" onkeyup="filterProducts()"
                            placeholder="Cari barang (Nama/SKU)..."
                            class="w-full pl-10 pr-4 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 transition-shadow">
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto p-4 bg-slate-50">
                    <div class="grid grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="product-grid">
                        <!-- JS injected -->
                    </div>
                </div>
            </div>

            <!-- Cart Section -->
            <div class="w-full md:w-[380px] flex flex-col bg-white rounded-lg border border-slate-200 shadow-sm">
                <div class="p-4 border-b border-slate-100 flex justify-between items-center bg-slate-50 rounded-t-lg">
                    <h3 class="font-bold text-slate-800 flex items-center gap-2">
                        <i class="ph ph-shopping-cart text-lg"></i> Keranjang
                    </h3>
                    <button onclick="clearCart()"
                        class="text-xs text-red-500 hover:text-red-700 font-medium hover:underline">Kosongkan</button>
                </div>

                <div class="flex-1 overflow-y-auto p-0" id="cart-items">
                    <div class="h-full flex flex-col items-center justify-center text-slate-400 p-8 text-center">
                        <i class="ph ph-basket text-5xl mb-3 opacity-20"></i>
                        <p class="text-sm">Belum ada barang dipilih</p>
                    </div>
                </div>

                <div class="p-5 border-t border-slate-100 bg-slate-50 rounded-b-lg space-y-4">
                    <div class="space-y-2 text-sm text-slate-600">
                        <div class="flex justify-between">
                            <span>Subtotal</span>
                            <span id="cart-subtotal" class="font-mono">Rp 0</span>
                        </div>
                    </div>
                    <div class="flex justify-between font-bold text-xl text-slate-900 border-t border-slate-200 pt-3">
                        <span>Total</span>
                        <span id="cart-total">Rp 0</span>
                    </div>
                    <button onclick="processPayment()"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white h-12 rounded-lg font-bold shadow-lg shadow-blue-200 transition-all active:scale-[0.98] flex items-center justify-center gap-2">
                        <i class="ph ph-printer text-lg"></i> Bayar & Cetak
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script>
        document.getElementById('date-display').innerText = new Date().toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });

        const products = [
            { id: 1, sku: 'SMN-001', name: 'Semen Gresik 50kg', price: 75000, unit: 'sak' },
            { id: 2, sku: 'SMN-002', name: 'Semen Tiga Roda', price: 73000, unit: 'sak' },
            { id: 3, sku: 'CAT-RED', name: 'Cat Avian Merah 1L', price: 55000, unit: 'klg' },
            { id: 4, sku: 'PKU-5CM', name: 'Paku 5cm', price: 15000, unit: 'kg' },
            { id: 5, sku: 'KRM-40', name: 'Keramik Putih 40x40', price: 65000, unit: 'dus' },
            { id: 6, sku: 'PLU-01', name: 'Palu Godam', price: 85000, unit: 'pcs' },
            { id: 7, sku: 'GRG-01', name: 'Gergaji Besi', price: 35000, unit: 'pcs' },
            { id: 8, sku: 'CAT-PLK', name: 'Cat Pelapis Anti Bocor', price: 120000, unit: 'klg' },
        ];

        let cart = [];

        function formatRupiah(number) {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(number);
        }

        function renderProducts(filterText = "") {
            const grid = document.getElementById('product-grid');
            const filtered = products.filter(p => p.name.toLowerCase().includes(filterText.toLowerCase()) || p.sku.toLowerCase().includes(filterText.toLowerCase()));

            grid.innerHTML = filtered.map(p => `
                <div onclick="addToCart(${p.id})" class="cursor-pointer bg-white border border-slate-200 rounded-lg p-3 hover:border-blue-500 hover:shadow-md transition-all group flex flex-col h-full justify-between">
                    <div>
                        <div class="text-sm font-bold text-slate-700 mb-1 group-hover:text-blue-600 line-clamp-2">${p.name}</div>
                        <div class="text-xs text-slate-400 font-mono mb-2 bg-slate-100 inline-block px-1 rounded">${p.sku}</div>
                    </div>
                    <div class="flex justify-between items-end mt-2">
                        <span class="font-bold text-sm text-slate-900">${formatRupiah(p.price)}</span>
                        <span class="text-[10px] text-slate-500 uppercase border border-slate-200 px-1.5 py-0.5 rounded bg-slate-50">${p.unit}</span>
                    </div>
                </div>
            `).join('');
        }

        function filterProducts() {
            const text = document.getElementById('search-input').value;
            renderProducts(text);
        }

        function addToCart(id) {
            const product = products.find(p => p.id === id);
            const existing = cart.find(c => c.id === id);
            if (existing) existing.qty++;
            else cart.push({ ...product, qty: 1 });
            renderCart();
        }

        function updateQty(id, delta) {
            const item = cart.find(c => c.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) cart = cart.filter(c => c.id !== id);
                renderCart();
            }
        }

        function clearCart() {
            if (cart.length > 0 && confirm("Kosongkan keranjang?")) {
                cart = []; renderCart();
            }
        }

        function renderCart() {
            const container = document.getElementById('cart-items');
            if (cart.length === 0) {
                container.innerHTML = `<div class="h-full flex flex-col items-center justify-center text-slate-400 p-8 text-center"><i class="ph ph-basket text-5xl mb-3 opacity-20"></i><p class="text-sm">Belum ada barang dipilih</p></div>`;
                document.getElementById('cart-subtotal').innerText = formatRupiah(0);
                document.getElementById('cart-total').innerText = formatRupiah(0);
                return;
            }

            let total = 0;
            container.innerHTML = cart.map(item => {
                const subtotal = item.price * item.qty;
                total += subtotal;
                return `
                    <div class="flex justify-between p-3 border-b border-slate-100 text-sm hover:bg-slate-50 transition-colors">
                        <div class="flex-1 pr-2">
                            <div class="font-semibold text-slate-700 line-clamp-1">${item.name}</div>
                            <div class="text-slate-500 text-xs mt-1">${formatRupiah(item.price)} x ${item.qty}</div>
                        </div>
                        <div class="flex flex-col items-end gap-1.5">
                            <div class="font-bold text-slate-800">${formatRupiah(subtotal)}</div>
                            <div class="flex items-center border border-slate-200 rounded-md bg-white overflow-hidden shadow-sm">
                                <button onclick="updateQty(${item.id}, -1)" class="px-2 py-0.5 hover:bg-slate-100 text-slate-600 transition-colors">-</button>
                                <span class="px-2 text-xs min-w-[1.5rem] text-center font-medium bg-slate-50 py-0.5 border-x border-slate-100">${item.qty}</span>
                                <button onclick="updateQty(${item.id}, 1)" class="px-2 py-0.5 hover:bg-slate-100 text-blue-600 transition-colors">+</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('cart-subtotal').innerText = formatRupiah(total);
            document.getElementById('cart-total').innerText = formatRupiah(total);
        }

        function processPayment() {
            if (cart.length === 0) return alert("Keranjang kosong!");
            if (confirm("Konfirmasi pembayaran tunai?")) {
                alert("Transaksi Berhasil Dicatat!\nStruk akan dicetak.");
                cart = []; renderCart();
            }
        }

        renderProducts();
    </script>
</body>

</html>